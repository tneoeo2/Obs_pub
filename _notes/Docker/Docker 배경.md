---
created: 2024-04-05 17:56
updated: 2024-04-05 17:56
tags:
  - docker
  - 도커
---
목차

- [[#모던 웹개발에서 Docker이 왜 필요할까?|모던 웹개발에서 Docker이 왜 필요할까?]]
- [[#배경|배경]]
	- [[#배경#하이퍼바이저|하이퍼바이저]]
		- [[#하이퍼바이저#역할|역할]]
	- [[#배경#컨테이너|컨테이너]]
		- [[#컨테이너#특징|특징]]
			- [[#특징#Cgroups(Control Groups)|Cgroups(Control Groups)]]
			- [[#특징#NameSpace|NameSpace]]
- [[#Docker 기본 개념과 구조|Docker 기본 개념과 구조]]
	- [[#Docker 기본 개념과 구조#Docker Engine|Docker Engine]]
		- [[#Docker Engine#구성 요소|구성 요소]]
		- [[#Docker Engine#동작방식|동작방식]]
		- [[#Docker Engine#용어 정리|용어 정리]]
			- [[#용어 정리#Docker Image|Docker Image]]
			- [[#용어 정리#Docker container|Docker container]]
			- [[#용어 정리#DockerFile|DockerFile]]
			- [[#용어 정리#Docker Hub|Docker Hub]]
			- [[#용어 정리#Docker Registry|Docker Registry]]

### 모던 웹개발에서 Docker이 왜 필요할까?
- 컨테이너는 무엇인가?
- 컨테이너를 왜 사용하는가?
---
### 배경
1960-70년대 : 한 컴퓨터가 한 애플리케이션 실행을 담당하는 것이 일반적. 프로세스도 오래걸림
-> 컴퓨팅 자원을 최대한 쉐어해서 빠르게 만들자 -> 여러 사용자가 자원을 사용하게 되면서 서로 간섭이 일어나는 경우가 생김 -> 한 명의 사용자가 시스템을 중단시켜버리는 경우가 발생
> ex) 하나의 프로그램이 사용하는 리소스를 다 사용해버리는 경우나 프로그램 에러가 나서 OS까지 영향을 미침

- `가상화`를 사용해서 하나의 컴퓨터에서 여러 애플리케이션을 구동
- 가상화는 원래 존재했다 : VM(Virtual Matchine)
	- 하이퍼바이저 가상화는 하드웨어 상에 `여러 개의 독립적인 가상 운영체제(가상 머신)를 실행`할 수 있게 해주는 기술
	  이를 통해 하나의 물리적 컴퓨터 내에서 여러 운영 체제를 동시에 실행할 수 있다. 각 가상 머신은 독립적인 컴퓨팅 환경을 제공받으며, 기존적인 하드웨어 자원(CPU, 메모리 스토리지 등)은 물리적 호스트 시스템에 의해 가상화된 형태로 할당된다.
	- 하이퍼바이저 가상화의 핵심은 하이퍼바이저라는 소프트웨어에 있다. 하이퍼바이저는 물리적 하드웨어와 가상 머신 사이에서 `중재자 역할`을 하며, 하드웨어 자산을 가상 머신에게 `분배`하고, 가상 머신들이 이 자원을 안전하고 효율적으로 사용할 수 있도록 `관리`한다.
	- 가상화를 통해, 개발자는 `다양한 운영 체제 위에서 애플리케이션을 테스트`하고, IT관리자는 서버를 더 효율적으로 활용하여 `비용을 절감`하며, `보안성이 높은 격리된 환경을 구성`할 수 있다.  또한, OS 가상화는 클라우드 컴퓨팅, 재해 복구, 시스템 마이그레이션과 같은 다양한 IT 요구 사항을 충족시키는데 핵심적인 역할을 함
#### 하이퍼바이저
하이퍼바이저는 가상화 환경을 생성하고 관리하는 소프트웨어 또는 펌웨어의 핵심 구성 요소다.그 주요 역할은 하나의 물리적 시스템 상에 `여러 개의 독립된 가상 머신(VM)을 실행할 수 있는 환경을 제공`하는 것이다. 
##### 역할
1. _자원 할당 및 관리_: 하이퍼바이저는 CPU, 메모리, 스토리지 등의 물리적 하드웨어 자원을 가상 머신에게 가상화된 형태로 할당하고 관리한다. 이는 각 가상 머신이 독립적인 운영 체제와 애플리케이션을 실행할 수 있는 독립된 환경을 가질 수 있게 한다.
2. _가상 머신 실행 및 모니터링_: 하이퍼바이저는 가상 머신의 생성, 실행, 중지 및 삭제와 같은 `생명주기를 관리`한다. 또한, 가상 머신의 성능과 자원 사용을 모니터링하여, 전체 시스템의 `효율성과 안정성`을 유지한다.
3. _격리 및 보안 유지_: 하이퍼바이저는 가`상 머신 사이에 강력한 격리를 제공`한다. 이는 각 가상 머신이 다른 가상 머신의 자원에 접근하거나 영향을 미치지 못하도록 보장하여, 시스템의 `보안성을 강화`한다.
4. _네트워킹 관리_: 가상 네트워크 인터페이스와 스위치를 통해 가상 머신 간의 `네트워크 통신을 가능`하게 하며, 필요에 따라 외부 네트워크와의 연결도 관리한다.

-> 하이퍼바이저는 이러한 기능을 통해 가상화 기술의 핵심적인 장점인 `자원 활용 최적화`, 유연한 인프라 관리, 비용 절감 등을 실현한다.

#### 컨테이너
VM과 다른 방법을 사용해서 효율 성능이 더 나아진 것이 `컨테이너`
- 컨테이너 가상화는 애플리케이션을 실행하는 데 필요한 코드, 런타임, 시스템 도구, 시스템 라이브러리 등을 포함하여 `가벼운, 격리된 환경을 생성하는 기술`
##### 특징
- 하이퍼바이저 가상화 : 여러 개의 독립적인 운영체제(가상 머신) 실행

- 컨테이너 가상화 : 운영체제 수준에서 격리, `하나의 호스트 시스템에서 여러 컨테이너를 실행`하여 자원을 효율적으로 사용함
	- 리눅스의 핵심 격리 기술 기반으로 하나의 리눅스 커널 위에 여러 개의 독립적인 사용자 공간 인스턴스를 실행할 수 있게 함
	- 주로 리눅스의 핵심 기능 _Cgroups(Control Groups)_ 와 _네임스페이스(Namespace)_ 를 활용하여 이루어진다.
###### Cgroups(Control Groups)
프로세스 그룹의 리소스 사용량(ex. CPU 시간, 시스템 메모리, 네트워크 대역폭)을 모니터링하고 제한하는 기능을 제공 -> 각 컨테이너가 할당된 자원을 초과하여 사용하는 것을 방지함으로써 시스템의 안정성을 유지하고 다른 컨테이너 or  시스템 전체에 미치는 영향을 최소화한다.

- _Cgroups (Control Groups) 예시_
>예를 들어, 시스템에 여러 컨테이너가 실행 중이고, 각각 다른 애플리케이션이 작동하고 있다고 가정해보자. 여기서 한 컨테이너가 너무 많은 CPU 시간을 사용하여 시스템의 다른 부분에 영향을미치기 시작한다면, 시스템 관리자는 Cgroups를 사용하여 그 컨테이너의 CPU 사용량을 제한할 수 있다. 예를 들어, cpu.shares 파라미터를 조정하여 특정 컨테이너 그룹이 사용할 수 있는 CPU 자원의 양을 조절할 수 있다. 이는 시스템 자원이 공정하게 분배되도록 보장하고, 한 애플리케이션이 전체 시스템을 점유하는 것을 방지한다.

###### NameSpace
프로세스에게 제한된 시스템 뷰를 제공, 프로세스가 자신의 네임스페이스 내에서만 시스템 리소스를 볼 수 있게 한다. -> 파일 시스템 마운트, 네트워크, 사용자 ID, 호스트 이름 등을 각 컨테이너마다 독립적으로 할당하고 관리할 수 있다. 네임스페이스는 컨테이너를 격리된 환경으로 만들어 주는 핵심 기술로, 컨테이너 내부에서 실행되는 프로세스가 호스트 시스템이나 다른 컨테이너의 리소스와 충돌하지 않도록 한다.

- _네임스페이스 (Namespace) 예시_
>네임스페이스는 시스템 리소스를 격리하여 프로세스 그룹이 해당 리소스를 독립적으로 보고 관리할 수 있게 한다. 예를 들어, PID (Process ID) 네임스페이스 를 사용하는 경우, 각 컨테이너는 자체적인 PID 1부터 시작하는 고유한 프로세스 번호 공간을 가지게 된다. 이는 컨테이너 내부에서 실행되는 프로세스가 시스템의 다른 부분이나 다른 컨테이너의 프로세스와 독립적으로 관리될 수 있음을 의미한다. 결과적으로, 컨테이너 내부의 애플리케이션은 자신이 전체 시스템에서 유일하게 실행되고 있는 것처럼 동작할 수 있으며, 이는 보안과 격리를 강화한다

__--> `Cgroups` 와 `네임스페이스`는 리눅스 커널의 두 가지 핵심 기술로, 컨테이너 가상화의 기반을 이룬다.__

![[Pasted image 20240407211354.png]]

### Docker 기본 개념과 구조
![[Pasted image 20240407211451.png]]

#### Docker Engine
![[Pasted image 20240407211645.png]]
- 도커 엔진(Docker Engine): `컨테이너를 생성하고 관리`하는 기능을 제공하는 `클라이언트-서버 형태`의 애플리케이션
##### 구성 요소
- _도커 데몬_ : 컨테이너 관리를 위한 백그라운드 프로세스로 이미지 생성, 컨테이너 실행, 네트워크 설정 등의 작업을 수행한다.
	- 컨테이너 생성, 실행, 중지 와 같은 생명주기를 관리한
	- 이미지 빌드, 저장소에서 가져오기 역할 수행
	- 다른 도커 클라이언트의 명령을 수행하기 위해 REST API를 통해 접근할 수 있다.
- _REST API_ : 도커 데몬과 통신하는 인터페이스로, 이 API를 통해 `다양한 도커 클라이언트가 도커 데몬과 상호작용`할 수 있다. 
	- 애플리케이션 배포, 관리, 확장을 위한 다양한 명령 수행
- _CLI 클라이언트_ : 사용자가 `커맨드 라인을 통해 도커 엔진과 상호작용`할 수 있게 하는 인터페이스
	- 컨테이너 생성, 관리
	- 이미지 빌드, 도커 허브 같은 이미지 저장소와 상호작용

##### 동작방식
도커 엔진의 동작방식은 기본적으로 `컨테이너의 생명 주기 관리와 관련된 일련의 과정을 포함`한다.
사용자 또는 애플리케이션은 도커 CLI  또는 API를 통해 도커 데몬과 상호작용하며, 도커 데몬은 이러한 명령을 수행하여 컨테이너를 생성, 실행, 중지 등의 작업을 관리한다.

1. _이미지 다운로드 또는 빌드_ : 컨테이너 실행 전, 도커 엔진은 해당 애플리케이션을 실행하는 데 필요한 모든 파일과 설정이 포함된 도커 이미지가 필요하다. 
   사용자는 도커 허브나 다른 이미지 저장소에서 이미지를 다운로드하거나, Dockerfile을 정의 하고 이를 통해 새로운 이미지를 빌드할 수 있다. 
2. _컨테이너 생성_ : 이미지가 준비되면, 사용자는 도커 데몬에게 컨테이너 생성을 요청
   네트워크 설정이나 볼륨 마운트와 같은 추가적인 옵션 지정 가능
   도커 데몬은 이러한 정보를 바탕으로 새로운 컨테이너의 인스턴스를 생성
3. _컨테이너 실행_: 컨테이너가 생성되면, 도커 데몬은 컨테이너 내부에서 정의된 애플리케이션을 실행. 이 과정에서 컨테이너는 독립된 파일 시스템, 네트워크 인터페이스, 프로세스 ID 공간 등을 갖게됨 -> 컨테이너를 호스트 시스템과 격리된 환경에서 실행되게한다.
4. _컨테이너 관리_: 도커 엔진은 실행 중인 컨테이너의 상태를 모니터링하고 관리. 사용자는 도커 CLI를 통해 실행 중인 컨테이너를 조회, 로그 확인, 필요한 경우 컨테이너 중지, 재시작, 삭제
5. _리소스 관리_: 도커 엔진은 Cgroups와 함께 네임스페이스와 같은 리눅스의 핵심 기능을 사용하여 컨테이너의 리소스 사용량을 제한, 컨테이너 간의 격리를 유지한다.
   -> 시스템의 안정성 보장, 다른 컨테이너나 시스템 전체에 부정적인 영향을 미치는 것을 감지
##### 용어 정리
###### Docker Image 
도커 이미지는 컨테이너를 실행하기 위한 불변의 템플릿이다. 이 이미지는 애플리케이션 실행에 필요한 모든 것을 포함한다
- 코드, 런타임, 애플리케이션과 관련된 라이브러리, 환경 변수 및 설정 파일 등. 
- 도커 이미지는 여러 계층으로 구성되어 있으며, 각 계층은 변경 사항을 저장한다. 
- 이미지는 컨테이너를 생성하는 데 사용되며, 일반적으로 도커허브와 같은 레지스트리에서 가져오거나 Dockerfile 을 사용해 직접 빌드할 수 있다.

###### Docker container
도커 컨테이너는 도커 이미지의 실행 인스턴스이다. 컨테이너는 이미지를 기반으로 하여 실행되며, 격리된 환경에서 애플리케이션과 그 의존성을 캡슐화한다. 
- 컨테이너는 가벼우며 시스템 리소스를 효율적으로 사용한다는 장점이 있다.
- 컨테이너는 시작될 때 생성되고 종료될 때 제거된다. 
- 동일한 이미지를 사용하여 여러 컨테이너를 동시에 실행할 수 있으며, 각 컨테이너는 독립적으로 실행되고 관리된다.

###### DockerFile
도커 이미지를 자동으로 빌드하기 위한 스크립트 파일
- 기본 이미지 설정, 실행할 명령어, 추가할 파일 및 디렉토리, 환경 변수 설정 등 이미지 생성에 필요한 지시어를 담고 있다.
- `docker build` 명령어와 함께 사용되어 새로운 도커 이미지를 생성
- dockerfile 사용하면 애플리케이션 배포 과정을 표준화하고 자동화 할 수 있다.
- 필요한 모든 설정과 의존성을 문서화하여 재현 가능하다.

###### Docker Hub
도커허브는 도커 이미지를 찾고, 공유하고, 관리할 수 있는 공식적인 클라우드 기반 서비스 및 저장소
- 사용자는 도커허브에서 수많은 공개 도커 이미지를 무료로 다운로드할 수 있으며, 자신의 도커 이미지를 업로드하여 공개하거나 비공개로 저장할 수도 있다. 
- 도커허브는 개발자와 조직이 컨테이너화된 애플리케이션을 쉽게 배포하고 공유할 수 있도록 지원하는 중앙 집중식 서비스이다. 
- 도커허브는 또한 자동이미지 빌드, 웹훅, 조직 및 팀을 위한 협업 툴 등과 같은 추가 기능을 제공한다.

###### Docker Registry
도커 레지스트리는 도커 이미지를 저장하고 배포하기 위한 서버 측 응용 프로그램이다. 
- 도커허브와 유사하게 동작하지만, 도커 레지스트리는는 사용자가 자신의 서버에` 직접 설치`하여 개인 또는 조직 내부에서 사용할 수 있는` 프라이빗 저장소를` 만들 수 있게 해준다.
-  비공개 프로젝트나 내부적으로 사용되는 이미지를 안전하게 관리하고 싶은 조직에 적합한 솔루션이다. 
-  보안, 액세스 제어, 저장소 한계 설정 등을 사용자가 직접 구성할 수 있게 해주며, 이를 통해 개인화된 컨테이너 이미지 저장소를 운영할 수 있다.
-  소프트웨어는 오픈 소스이며, Docker Inc.에 의해 관리된다.